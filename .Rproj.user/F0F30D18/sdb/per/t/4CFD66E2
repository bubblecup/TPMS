{
    "collab_server" : "",
    "contents" : "suppressMessages({\n        require(dplyr)  \n        require(lubridate)\n        require(ggplot2)\n})\n\n# Reads in the file in the desired format\nreadData <- function(filename, trip.no=1) {\n        read.table(file=filename, \n                   col.name=c(\"date\",\"modulation\",\"bitrate\",\"preamble\",\"encoding\",\"packet\"),\n                   colClasses = c(\"character\",\"factor\",\"numeric\",\"character\",\"factor\",\"character\"),\n                   skip=3) %>% mutate(trip=trip.no)\n}\n\nanalyzeOdyssey <- function(returnAll=F) {\n        # Read in the data from odyssey*.txt files in the current dir\n        files <- list.files(\n                getwd(), pattern=\"odyssey(.*).txt\", full.names=T, ignore.case=T) \n        odyssey <- do.call(rbind,lapply(seq_along(files), function(x) readData(files[x],x))) %>%\n                analyzeTPMS(evalq(if(!returnAll)\"110110101110001\")) %>%\n                # The tire IDs are bits 25-56 of the packet data for Odyssey (we think)\n                group_by_(if(returnAll) \"preamble\" else \"tireID=substr(packet,25,56)\")\n        odyssey\n}\n\nanalyzeAcura <- function() {\n        acura <- analyzeTPMS(readData(\"acura.txt\"), \"01010101010101010101010101010110\")\n        acura\n}\n\nanalyzePacket <- function(packets, startBit, stopBit) {\n        sapply(packets, substr, startBit, stopBit, USE.NAMES=F)\n}\n\nanalyzeTPMS <- function(tpms, carID=NULL) {\n        \n        tpms <- # Filter only the relevant data if necessary\n                if(!is.null(carID)) filter(tpms, preamble==carID) else tpms %>%\n                # Convert date\n                mutate(date=ymd_hms(date)) %>%\n                # Group by trip\n                group_by(trip)\n \n        # Return the dataframe\n        tpms\n}\n\nplotCountBy <- function(data, x, facet=trip) {\n       eval(substitute(ggplot(data, aes(x)))) + stat_count() + \n                eval(substitute(facet_grid(facet~.))) +\n                theme(axis.text.x=element_text(angle=90, hjust=1))\n}\n",
    "created" : 1489781576928.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2362156249",
    "id" : "4CFD66E2",
    "lastKnownWriteTime" : 1490121859,
    "last_content_update" : 1490121859105,
    "path" : "~/Desktop/TPMS/tpms.R",
    "project_path" : "tpms.R",
    "properties" : {
        "docOutlineVisible" : "0"
    },
    "relative_order" : 4,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}